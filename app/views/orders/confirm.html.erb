<body>
  <div class="container">
    <h2>登録内容の確認</h2>

    <table class="table table-hover">
    <thead>
        <tr>
            <th>商品名</th>
            <th>単価(税込)</th>
            <th>数量</th>
            <th>小計</th>
        </tr>
    </thead>
    <tbody>
        <% @sum = 0 %>
        <% @cart_items.each do |cart_item| %>
        <tr>
            <td><%= cart_item.item.name %></td>
            <td><%= cart_item.item.price %></td>
            <td><%= cart_item.item_quantity %></td>
            <td><%= (cart_item.item.price) * (cart_item.item_quantity) %></td>

            <!-- 注文合計金額 -->
            <% @sum += (cart_item.item.price) * (cart_item.item_quantity) %>
        </tr>
        <% end %>
    </tbody>
</table>

<table class="table table-hover">
        <tr>
            <th>送料</th>
            <td>800</td>
        </tr>
            <th>商品合計</th>
            <td><%= @sum %></td>
        <tr>
            <th>合計金額</th>
            <td><%= @sum + 800 %></td>
        </tr>
</table>
    <%= form_with model: [@order_new], url:orders_path, method: :post, local: true do |f| %>

    <%= f.hidden_field :customer_id, value:current_customer.id %>
    <%= f.hidden_field :pay_method, value: 'クレジットカード' %>
    <%= f.hidden_field :status, value: '入金待ち' %>
    <%= f.hidden_field :freight, value: @freight %>
    <%= f.hidden_field :total, value: @sum + 800 %>
    <%= f.hidden_field :ship_name, value: params[:order][:ship_name] %>
    <%= f.hidden_field :ship_postcode, value: params[:order][:ship_code] %>
    <%= f.hidden_field :ship_address, value: @order_address %>

    <%= f.submit"戻る",name: 'back',class:'btn btn-secondary mr-3'%>
    <%= f.submit"購入を確定する",class:'btn btn-primary'%>
    <% end %>
  </div>
<br><span>支払い方法</span><br/>
    <%= @pay_method %><br>

<br><span>お届け先</span><br/>
    <%= @order_address %><br>
</body>
</html>